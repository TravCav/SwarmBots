<!DOCTYPE html>
<html lang="en">

<head>
  <title>Vis Network | Data | Custom Scaling</title>

  <style type="text/css">
    html,
    body {
      font: 10pt arial;
    }

    #mynetwork {
      width: 900px;
      height: 900px;
      border: 1px solid lightgray;
    }
  </style>

  <script type="text/javascript" src="vis-network.min.js"></script>

  <script type="text/javascript">
    var nodes = null;
    var edges = null;
    var network = null;

    function draw() {
      var cachedBrain = JSON.parse(localStorage.getItem("Brain1"));
      if (cachedBrain != null) {
      nodes = [];

      for (let layerIndex = 0; layerIndex < cachedBrain.length; layerIndex++) {
        for (let neuronIndex = 0; neuronIndex < cachedBrain[layerIndex].length; neuronIndex++) {
          let groupLabel = "";
          if (layerIndex == 0) { groupLabel = "Input "; }
          if (layerIndex > 0 && layerIndex < 3) { groupLabel = "Hidden " + layerIndex + " "; }
          if (layerIndex == 3) { groupLabel = "Output "; }
          let neuronLabel = "";

          if (layerIndex == 0 || layerIndex == 3) {
            neuronLabel = cachedBrain[layerIndex][neuronIndex].label;
          }

          neuronLabel += " (" + groupLabel + ") [" + layerIndex + "." + neuronIndex + "]"

          nodes.push({ id: layerIndex + "." + neuronIndex, label: neuronLabel, group: groupLabel })
        }
      }

      nodes[nodes.length-1].x = 0;
      nodes[nodes.length-2].x = 100;
      nodes[nodes.length-3].x = 200;
      nodes[nodes.length-4].x = 300;
      nodes[nodes.length-5].x = 400;
      nodes[nodes.length-6].x = 500;
      nodes[nodes.length-7].x = 600;
      nodes[nodes.length-8].x = 700;

      // create connections between people
      // value corresponds with the amount of contact between two people
      edges = [];

      for (let layerIndex = 1; layerIndex < cachedBrain.length; layerIndex++) {
        for (let neuronIndex = 0; neuronIndex < cachedBrain[layerIndex].length; neuronIndex++) {
          for (let connectionIndex = 0; connectionIndex < cachedBrain[layerIndex][neuronIndex].connections.length; connectionIndex++) {
            if (cachedBrain[layerIndex][neuronIndex].connections[connectionIndex].weight > 0) {
              edges.push({ from: (layerIndex - 1) + "." + connectionIndex, to: layerIndex + "." + neuronIndex, value: Math.abs(cachedBrain[layerIndex][neuronIndex].connections[connectionIndex].weight), arrows: "to" })
            }
          }
        }
      }

      // Instantiate our network object.
      var container = document.getElementById("mynetwork");
      var data = {
        nodes: nodes,
        edges: edges,
      };
      var options = {
        nodes: {
          shape: "dot",
          size: 16
        },
        interaction: {
          tooltipDelay: 200,
          //hideEdgesOnDrag: true
        },
        edges: {
          smooth: true
        },
        physics: {
          forceAtlas2Based: {
            theta: 0.5,
            gravitationalConstant: -150,
            centralGravity: 0.03,
            springConstant: 0.04,
            springLength: 100,
            damping: 5,
            avoidOverlap: 0
          },
          maxVelocity: 1046,
          solver: "forceAtlas2Based",
          timestep: 0.25,
          stabilization: { iterations: 0 }
        },
        configure: {
          filter: function (option, path) {
            if (path.indexOf("physics") !== -1) {
              return true;
            }
            if (path.indexOf("smooth") !== -1 || option === "smooth") {
              return true;
            }
            return false;
          },
          container: document.getElementById("config")
        }
      };
      network = new vis.Network(container, data, options);
    }
    }
  </script>
</head>

<body onload="draw()">
  <input type="button" value="redraw" onclick="draw()" />
  <div id="mynetwork"></div>
  <div id="config"></div>
</body>

</html>